{"ast":null,"code":"import _slicedToArray from\"/home/styxx/full_stack_open/part3/persons/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import personService from\"./services/persons.js\";import\"./index.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Filter=function Filter(_ref){var filter=_ref.filter,setFilter=_ref.setFilter;return/*#__PURE__*/_jsxs(\"div\",{children:[\"Filter name with\",\" \",/*#__PURE__*/_jsx(\"input\",{value:filter,onChange:function onChange(event){setFilter(event.target.value);}})]});};var Message=function Message(_ref2){var isError=_ref2.isError,text=_ref2.text;if(!text)return null;return/*#__PURE__*/_jsx(\"div\",{className:isError?\"error\":\"success\",children:text});};var PersonForm=function PersonForm(_ref3){var persons=_ref3.persons,setPersons=_ref3.setPersons,setMessage=_ref3.setMessage,setError=_ref3.setError;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),newName=_useState2[0],setNewName=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),newNumber=_useState4[0],setNewNumber=_useState4[1];var displayError=function displayError(text){setError(true);setMessage(text);};var displaySuccess=function displaySuccess(text){console.log(text);setMessage(text);setError(false);};return/*#__PURE__*/_jsxs(\"form\",{onSubmit:function onSubmit(event){event.preventDefault();if(persons.map(function(a){return a.name;}).includes(newName)){if(window.confirm(\"\".concat(newName,\" already exists in the Phonebook,replace the old number with a new one?\"))){var changedPerson={name:newName,number:newNumber,id:persons.find(function(person){return person.name===newName;}).id};personService.update(changedPerson,changedPerson.id).then(function(changedPerson){setPersons(persons.map(function(person){return person.id!=changedPerson.id?person:changedPerson;}));setNewName(\"\");setNewNumber(\"\");}).catch(function(error){console.log(error);displayError(\"\".concat(newName,\" has been deleted from the database.\"));setTimeout(function(){return displayError(null);},3000);personService.getAll().then(function(persons){return setPersons(persons);});});}}else{var newPerson={name:newName,number:newNumber};personService.create(newPerson).then(function(newPerson){displaySuccess(\"\".concat(newName,\" successfully added.\"));setTimeout(function(){return displaySuccess(null);},5000);setPersons(persons.concat(newPerson));setNewName(\"\");setNewNumber(\"\");});}},children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"name:\",\" \",/*#__PURE__*/_jsx(\"input\",{value:newName,onChange:function onChange(event){setNewName(event.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"number:\",\" \",/*#__PURE__*/_jsx(\"input\",{value:newNumber,onChange:function onChange(event){setNewNumber(event.target.value);}})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"add\"})})]});};var Persons=function Persons(_ref4){var persons=_ref4.persons,deletePerson=_ref4.deletePerson;return/*#__PURE__*/_jsx(\"div\",{children:persons.map(function(person){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[person.name,\": \",person.number]}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){if(window.confirm(\"Delete \".concat(person.name,\"?\")))deletePerson(person.id);},children:\"Delete\"})]},person.id);})});};var App=function App(){var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),persons=_useState6[0],setPersons=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),filter=_useState8[0],setFilter=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),message=_useState10[0],setMessage=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isError=_useState12[0],setError=_useState12[1];useEffect(function(){personService.getAll().then(function(persons){setPersons(persons);});},[]);var displayedPersons=filter?persons.filter(function(person){return person.name.toLowerCase().includes(filter.toLowerCase());}):persons;var deletePerson=function deletePerson(id){return personService.del(id).then(function(deletedPersonId){setPersons(persons.filter(function(person){return person.id!==deletedPersonId;}));}).catch(function(error){personService.getAll().then(function(persons){return setPersons(persons);});});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Phonebook\"}),/*#__PURE__*/_jsx(Message,{isError:isError,text:message}),/*#__PURE__*/_jsx(Filter,{filter:filter,setFilter:setFilter}),/*#__PURE__*/_jsx(\"h2\",{children:\"Add a New\"}),/*#__PURE__*/_jsx(PersonForm,{persons:persons,setPersons:setPersons,setMessage:setMessage,setError:setError}),/*#__PURE__*/_jsx(\"h2\",{children:\"Numbers\"}),/*#__PURE__*/_jsx(Persons,{persons:displayedPersons,deletePerson:deletePerson})]});};export default App;","map":{"version":3,"names":["useState","useEffect","personService","Filter","filter","setFilter","event","target","value","Message","isError","text","PersonForm","persons","setPersons","setMessage","setError","newName","setNewName","newNumber","setNewNumber","displayError","displaySuccess","console","log","preventDefault","map","a","name","includes","window","confirm","changedPerson","number","id","find","person","update","then","catch","error","setTimeout","getAll","newPerson","create","concat","Persons","deletePerson","App","message","displayedPersons","toLowerCase","del","deletedPersonId"],"sources":["/home/styxx/full_stack_open/part3/persons/frontend/src/App.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport personService from \"./services/persons.js\";\nimport \"./index.css\"\nconst Filter = ({ filter, setFilter }) => {\n  return (\n    <div>\n      Filter name with{\" \"}\n      <input\n        value={filter}\n        onChange={(event) => {\n          setFilter(event.target.value);\n        }}\n      />\n    </div>\n  );\n};\nconst Message = ({ isError,text }) => {\n  if (!text)return null;\n  return( <div className = {isError?\"error\":\"success\"}>\n    {text}\n  </div>)\n}\n\nconst PersonForm = ({ persons, setPersons,setMessage,setError}) => {\n  const [newName, setNewName] = useState(\"\");\n  const [newNumber, setNewNumber] = useState(\"\");\n  const displayError = (text) => {\n    setError(true)\n    setMessage(text)\n  }\n  const displaySuccess = (text) => {\n    console.log(text)\n    setMessage(text)\n    setError(false)\n  }\n  \n  return (\n    <form\n      onSubmit={(event) => {\n        event.preventDefault();\n        if (persons.map((a) => a.name).includes(newName)) {\n          if (\n            window.confirm(\n              `${newName} already exists in the Phonebook,replace the old number with a new one?`\n            )\n          ) {\n            const changedPerson = {\n              name: newName,\n              number: newNumber,\n              id: persons.find((person) => person.name === newName).id,\n            };\n            personService.update(changedPerson, changedPerson.id)\n            .then(\n              (changedPerson) => {\n                setPersons(\n                  persons.map((person) =>\n                    person.id != changedPerson.id ? person : changedPerson\n                  )\n                );\n                setNewName(\"\");\n                setNewNumber(\"\");\n              }\n            )\n            .catch(error => {\n                console.log(error)\n                displayError(`${newName} has been deleted from the database.`);\n                setTimeout(() => displayError(null), 3000);\n                personService.getAll().then(persons => \n                  setPersons(persons)\n                );      \n            })\n          }\n        } else {\n          const newPerson = { name: newName, number: newNumber };\n          personService.create(newPerson).then((newPerson) => {\n            displaySuccess(`${newName} successfully added.`);\n            setTimeout(() => displaySuccess(null), 5000);\n            setPersons(persons.concat(newPerson));\n            setNewName(\"\");\n            setNewNumber(\"\");\n          });\n        }\n      }}\n    >\n      <div>\n        name:{\" \"}\n        <input\n          value={newName}\n          onChange={(event) => {\n            setNewName(event.target.value);\n          }}\n        />\n      </div>\n      <div>\n        number:{\" \"}\n        <input\n          value={newNumber}\n          onChange={(event) => {\n            setNewNumber(event.target.value);\n          }}\n        />\n      </div>\n      <div>\n        <button type=\"submit\">add</button>\n      </div>\n    </form>\n  );\n};\n\nconst Persons = ({ persons, deletePerson }) => {\n  return (\n    <div>\n      {persons.map((person) => (\n        <div key={person.id}>\n          <p>\n            {person.name}: {person.number}\n          </p>\n          <button\n            onClick={() => {\n              if (window.confirm(`Delete ${person.name}?`))\n                deletePerson(person.id);\n            }}\n          >\n            Delete\n          </button>\n        </div>\n      ))}\n    </div>\n  );\n};\n\nconst App = () => {\n  const [persons, setPersons] = useState([]);\n  const [filter, setFilter] = useState(\"\");\n  const [message,setMessage] = useState(null);\n  const [isError,setError] = useState(false);\n  useEffect(() => {\n    personService.getAll().then((persons) => {\n      setPersons(persons);\n    });\n  }, []);\n  const displayedPersons = filter\n    ? persons.filter((person) =>\n        person.name.toLowerCase().includes(filter.toLowerCase())\n      )\n    : persons;\n  const deletePerson = (id) =>\n    personService.del(id).then(\n      (deletedPersonId) => {\n        setPersons(persons.filter((person) => person.id !== deletedPersonId));\n      }\n    )\n    .catch(error => {\n      personService.getAll().then(persons => setPersons(persons))\n    })\n  return (\n    <div>\n      <h2>Phonebook</h2>\n      <Message isError = {isError} text = {message}/>\n      <Filter filter={filter} setFilter={setFilter} />\n      <h2>Add a New</h2>\n      <PersonForm persons={persons} setPersons={setPersons} setMessage = {setMessage} setError = {setError}/>\n      <h2>Numbers</h2>\n      <Persons persons={displayedPersons} deletePerson={deletePerson} />\n    </div>\n  );\n};\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}